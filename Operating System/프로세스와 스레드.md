# 프로세스와 스레드
<br><br>

## 프로세스
- **실행중인 프로그램**으로, **디스크로부터 메모리에 적재되어 CPU 의 할당을 받을 수 있는 프로그램**을 말한다. 운영체제로부터 `주소 공간`, `파일`, `메모리` 등을 할당받으며 이것들을 총칭하여 프로세스라고 한다. 프로세스는 각각의 독립된 메모리 영역을 할당받고, 해당 메모리 영역은 `Code`, `Data`, `Stack`, `Heap` 으로 이루어진다.
<br>

- **각각의 프로세스들은 서로 독립된 메모리 영역을 갖기 때문에 서로 메모리를 공유할 수 없다**. 따라서 `IPC`(파이프, 소켓, 공유메모리 등) 를 이용하여 프로세스끼리의 통신을 한다.
<br><br>

#### PCB (Process Control Block)
- **특정 프로세스에 대한 중요한 정보를 저장하고 있는 운영체제의 자료구조**이다. PCB 에는 프로세스 식별자, 프로세스 상태, 프로그램 카운터, CPU 레지스터, CPU 스케줄링 정보 등이 저장되어있다. 프로세스는 CPU 를 할당받아 작업을 처리하다가도 프로세스 전환이 발생하면, 진행하던 작업들을 PCB 에 저장한 뒤 CPU 를 반환한다(Context Switching).
<br>

#### Context Switching
- 인터럽트를 발생시켜 CPU 에서 실행중인 프로세스를 중단하고, 다른 프로세스를 처리하기 위한 과정이다. 현재 실행중인 프로세스의 상태(Context) 를 PCB 에 저장하고, 다음 프로세스를 동작시켜 작업을 처리한 후에, 이전에 저장된 프로세스의 상태를 다시 복구한다.
<br><br><br><br>

## 스레드
- 모든 프로세스는 스레드를 1개 이상 가지고 있다. 스레드는 **한 프로세스 내에서 동작되는 여러 실행 흐름으로 프로세스 내의 주소 공간 이나 자원 을 공유할 수 있다**. `스레드ID`, `PC`, `레지스터`, `스택` 으로 구성된다. 스레드는 **같은 프로세스에 속한 스레드와 스택 영역을 제외한 영역들을 공유**한다. 각각의 스레드는 독립적인 작업을 수행해야 하기 때문에 각자의 스택 과 PC 를 가지고 있다.
<br><br>

#### 사용자 레벨 스레드
- 커널 영역 상위에서 지원되며 **사용자 레벨의 라이브러리르 통해 구현**된다. `라이브러리`가 스레드의 생성 및 스케줄링을 관리한다. 동일한 메모리 영역에서 스레드가 생성 및 관리되므로 **속도가 빠르지만**, 여러 개의 사용자 스레드 중 **하나의 스레드가 시스템 호출 등으로 중단되면, 나머지 스레드 역시 중단**된다는 단점이 있다.
#### 커널 레벨 스레드
- 운영체제가 지원하는 스레드 기능으로 구현되며, `커널`이 스레드의 생성 및 스케줄링을 관리한다. **스레드가 시스템 호출 등으로 중단되더라도, 커널은 프로세스 내의 다른 스레드를 중단시키지 않고 계속 실행시켜준다**. 다만, 사용자 스레드에 비해 **생성 및 관리하는 것이 느리다**.
<br><br>

#### 스택을 스레드마다 독립적으로 할당하는 이유
- **스택은 함수 호출 시 전달되는 인자, 되돌아갈 주소값, 지역 변수 등을 저장하기 위한 공간**이다. 스레드는 **독립적인 함수 호출**이 가능하도록 하기 위한 최소 조건으로 독립된 스택을 할당한다.

#### PC Register를 스레드마다 독립적으로 할당하는 이유
- **PC 값은 스레드의 명령어가 어디까지 수행하였는지를 나타낸다**. 스레드는 CPU 를 할당받았다가 스케줄러에 의해 다시 선점당한다. 따라서 **그 전의 수행시점을 알기 위한 최소 조건**으로 PC 레지스터를 독립적으로 할당한다.
